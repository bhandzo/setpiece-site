---
import { menuLinks } from "@/site.config";
import { siteConfig } from "../../site.config";
---

<header
  class="col-span-3 md:col-span-6 lg:col-span-9 grid grid-cols-3 md:grid-cols-6 lg:grid-cols-9 items-center gap-4 z-90 bg-global-bg"
  id="main-header"
>
  <!-- Logo/Brand - Left side -->
  <div class="col-span-2 md:col-span-3 lg:col-span-3">
    <a
      aria-current={Astro.url.pathname === "/" ? "page" : false}
      class="inline-flex items-baseline gap-3 hover:text-accent transition-colors"
      href="/"
    >
      <img src="/logo.svg" alt="Setpiece Logo" class="w-8 h-8 flex-shrink-0" />
      <span class="text-lg font-medium tracking-tight whitespace-nowrap"
        >{siteConfig.title}</span
      >
    </a>
  </div>

  <!-- Navigation - desktop only while debugging -->
  <nav
    aria-label="Main menu"
    class="col-span-1 md:col-span-3 lg:col-span-6"
    id="navigation-menu"
  >
    <div class="hidden md:flex items-baseline space-x-8 leading-none">
      {
        menuLinks.map((link) => (
          <a
            aria-current={Astro.url.pathname === link.path ? "page" : false}
            class="text-sm uppercase tracking-wide hover:text-accent transition-colors leading-none"
            href={link.path}
          >
            {link.title}
          </a>
        ))
      }
    </div>
  </nav>

  <!-- Mobile controls removed during debugging -->
</header>

<script>
  import { toggleClass } from "@/utils/domElement";

  class MobileNavBtn extends HTMLElement {
    #menuOpen: boolean = false;

    connectedCallback() {
      const headerEl = document.getElementById("main-header")!;
      const mobileButtonEl = this.querySelector<HTMLButtonElement>("button");

      mobileButtonEl?.addEventListener("click", () => {
        if (headerEl) toggleClass(headerEl, "menu-open");
        this.#menuOpen = !this.#menuOpen;
        mobileButtonEl.setAttribute("aria-expanded", this.#menuOpen.toString());
      });
    }
  }

  customElements.define("mobile-button", MobileNavBtn);
</script>
