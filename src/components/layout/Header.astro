---
import { menuLinks } from "@/site.config";
import { siteConfig } from "../../site.config";
---

<header class="gc-full grid-local py-5" id="main-header">
  <!-- Logo/Brand - Left side -->
  <div class="col-span-2 lg:col-span-3">
    <a
      aria-current={Astro.url.pathname === "/" ? "page" : false}
      class="hover:text-accent transition-colors"
      href="/"
    >
      <img src="/logo.svg" alt="Setpiece Logo" class="w-8 h-8 float-left" />
      <span class="text-lg font-medium tracking-tight float-left mt-0.5 ml-3"
        >{siteConfig.title}</span
      >
    </a>
  </div>

  <!-- Navigation - Right aligned -->
  <nav
    aria-label="Main menu"
    class="col-span-1 col-start-3 md:col-start-6 lg:col-start-10 mt-1.5"
    id="navigation-menu"
  >
    <div class="leading-none">
      {
        menuLinks.map((link) => (
          <a
            aria-current={Astro.url.pathname === link.path ? "page" : false}
            class="pr-1.5 text-sm uppercase tracking-wide hover:text-accent transition-colors leading-none"
            href={link.path}
          >
            {link.title}
          </a>
        ))
      }
    </div>
  </nav>

  <!-- Mobile controls removed during debugging -->
</header>

<script>
  import { toggleClass } from "@/utils/domElement";

  class MobileNavBtn extends HTMLElement {
    #menuOpen: boolean = false;

    connectedCallback() {
      const headerEl = document.getElementById("main-header")!;
      const mobileButtonEl = this.querySelector<HTMLButtonElement>("button");

      mobileButtonEl?.addEventListener("click", () => {
        if (headerEl) toggleClass(headerEl, "menu-open");
        this.#menuOpen = !this.#menuOpen;
        mobileButtonEl.setAttribute("aria-expanded", this.#menuOpen.toString());
      });
    }
  }

  customElements.define("mobile-button", MobileNavBtn);
</script>
