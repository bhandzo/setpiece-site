---
import { menuLinks } from "@/site.config";
import { siteConfig } from "../../site.config";
---

<header
  class="col-span-12 grid grid-cols-12 gap-6 items-baseline"
  id="main-header"
>
  <!-- Logo/Brand - Left side -->
  <div class="col-span-5 md:col-span-5">
    <a
      aria-current={Astro.url.pathname === "/" ? "page" : false}
      class="inline-flex items-baseline gap-3 hover:text-accent transition-colors"
      href="/"
    >
      <img src="/logo.svg" alt="Setpiece Logo" class="w-8 h-8 flex-shrink-0" />
      <span class="text-lg font-medium tracking-tight whitespace-nowrap"
        >{siteConfig.title}</span
      >
    </a>
  </div>

  <!-- Navigation - Aligned with hero -->
  <nav
    aria-label="Main menu"
    class="col-span-6 md:col-span-4 md:col-start-7 order-3 md:order-2 mt-4 md:mt-0 flex items-baseline"
    id="navigation-menu"
  >
    <div class="hidden md:flex items-baseline space-x-8 leading-none">
      {
        menuLinks.map((link) => (
          <a
            aria-current={Astro.url.pathname === link.path ? "page" : false}
            class="text-sm uppercase tracking-wide hover:text-accent transition-colors leading-none"
            href={link.path}
          >
            {link.title}
          </a>
        ))
      }
    </div>

    <!-- Mobile navigation -->
    <div class="md:hidden group-[.menu-open]:block hidden">
      <div class="flex flex-col space-y-2 pt-4 border-t border-ink/10">
        {
          menuLinks.map((link) => (
            <a
              aria-current={Astro.url.pathname === link.path ? "page" : false}
              class="text-sm uppercase tracking-wide hover:text-accent transition-colors"
              href={link.path}
            >
              {link.title}
            </a>
          ))
        }
      </div>
    </div>
  </nav>

  <!-- Controls - Right side -->
  <div
    class="col-span-6 md:col-span-2 md:col-start-11 order-2 md:order-3 flex items-center justify-end space-x-3"
  >
    <!-- Mobile menu button -->
    <mobile-button>
      <button
        aria-expanded="false"
        aria-haspopup="menu"
        class="group relative h-6 w-6 md:hidden"
        id="toggle-navigation-menu"
        type="button"
      >
        <span class="sr-only">Open main menu</span>
        <svg
          aria-hidden="true"
          class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
          fill="none"
          focusable="false"
          id="line-svg"
          stroke="currentColor"
          stroke-width="1.5"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3.75 9h16.5m-16.5 6.75h16.5"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
        <svg
          aria-hidden="true"
          class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
          fill="none"
          focusable="false"
          id="cross-svg"
          stroke="currentColor"
          stroke-width="1.5"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M6 18L18 6M6 6l12 12"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
      </button>
    </mobile-button>
  </div>
</header>

<script>
  import { toggleClass } from "@/utils/domElement";

  class MobileNavBtn extends HTMLElement {
    #menuOpen: boolean = false;

    connectedCallback() {
      const headerEl = document.getElementById("main-header")!;
      const mobileButtonEl = this.querySelector<HTMLButtonElement>("button");

      mobileButtonEl?.addEventListener("click", () => {
        if (headerEl) toggleClass(headerEl, "menu-open");
        this.#menuOpen = !this.#menuOpen;
        mobileButtonEl.setAttribute("aria-expanded", this.#menuOpen.toString());
      });
    }
  }

  customElements.define("mobile-button", MobileNavBtn);
</script>
