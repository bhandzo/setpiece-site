---
import Search from "@/components/Search.astro";
import ThemeToggle from "@/components/ThemeToggle.astro";
import { menuLinks } from "@/site.config";
import { siteConfig } from "../../site.config";
---

<header
  class="grid grid-cols-12 gap-6 items-baseline container"
  id="main-header"
>
  <!-- Logo/Brand - Left side -->
  <div class="col-span-6 md:col-span-3">
    <a
      aria-current={Astro.url.pathname === "/" ? "page" : false}
      class="inline-flex items-center hover:text-accent transition-colors"
      href="/"
    >
      <svg
        aria-hidden="true"
        class="me-2 h-6 w-4"
        fill="none"
        focusable="false"
        viewBox="0 0 272 480"
        xmlns="http://www.w3.org/2000/svg"
      >
        <title>Logo</title>
        <path
          d="M181.334 93.333v-40L226.667 80v40l-45.333-26.667ZM136.001 53.333 90.667 26.667v426.666L136.001 480V53.333Z"
          fill="#B04304"></path>
        <path
          d="m136.001 119.944 45.333-26.667 45.333 26.667-45.333 26.667-45.333-26.667ZM90.667 26.667 136.001 0l45.333 26.667-45.333 26.666-45.334-26.666ZM181.334 53.277l45.333-26.666L272 53.277l-45.333 26.667-45.333-26.667ZM0 213.277l45.333-26.667 45.334 26.667-45.334 26.667L0 213.277ZM136 239.944l-45.333-26.667v53.333L136 239.944Z"
          fill="#FF5D01"></path>
        <path
          d="m136 53.333 45.333-26.666v120L226.667 120V80L272 53.333V160l-90.667 53.333v240L136 480V306.667L45.334 360V240l45.333-26.667v53.334L136 240V53.333Z"
          fill="#53C68C"></path>
        <path d="M45.334 240 0 213.334v120L45.334 360V240Z" fill="#B04304"
        ></path>
      </svg>
      <span class="text-lg font-medium tracking-tight">{siteConfig.title}</span>
    </a>
  </div>

  <!-- Navigation - Center -->
  <nav
    aria-label="Main menu"
    class="col-span-12 md:col-span-6 order-3 md:order-2 mt-4 md:mt-0"
    id="navigation-menu"
  >
    <div class="hidden md:flex justify-center space-x-8">
      {
        menuLinks.map((link) => (
          <a
            aria-current={Astro.url.pathname === link.path ? "page" : false}
            class="text-sm uppercase tracking-wide hover:text-accent transition-colors"
            href={link.path}
          >
            {link.title}
          </a>
        ))
      }
    </div>

    <!-- Mobile navigation -->
    <div class="md:hidden group-[.menu-open]:block hidden">
      <div class="flex flex-col space-y-2 pt-4 border-t border-ink/10">
        {
          menuLinks.map((link) => (
            <a
              aria-current={Astro.url.pathname === link.path ? "page" : false}
              class="text-sm uppercase tracking-wide hover:text-accent transition-colors"
              href={link.path}
            >
              {link.title}
            </a>
          ))
        }
      </div>
    </div>
  </nav>

  <!-- Controls - Right side -->
  <div
    class="col-span-6 md:col-span-3 order-2 md:order-3 flex items-center justify-end space-x-3"
  >
    <Search />
    <ThemeToggle />

    <!-- Mobile menu button -->
    <mobile-button>
      <button
        aria-expanded="false"
        aria-haspopup="menu"
        class="group relative h-6 w-6 md:hidden"
        id="toggle-navigation-menu"
        type="button"
      >
        <span class="sr-only">Open main menu</span>
        <svg
          aria-hidden="true"
          class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
          fill="none"
          focusable="false"
          id="line-svg"
          stroke="currentColor"
          stroke-width="1.5"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3.75 9h16.5m-16.5 6.75h16.5"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
        <svg
          aria-hidden="true"
          class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
          fill="none"
          focusable="false"
          id="cross-svg"
          stroke="currentColor"
          stroke-width="1.5"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M6 18L18 6M6 6l12 12"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
        </svg>
      </button>
    </mobile-button>
  </div>
</header>

<script>
  import { toggleClass } from "@/utils/domElement";

  class MobileNavBtn extends HTMLElement {
    #menuOpen: boolean = false;

    connectedCallback() {
      const headerEl = document.getElementById("main-header")!;
      const mobileButtonEl = this.querySelector<HTMLButtonElement>("button");

      mobileButtonEl?.addEventListener("click", () => {
        if (headerEl) toggleClass(headerEl, "menu-open");
        this.#menuOpen = !this.#menuOpen;
        mobileButtonEl.setAttribute("aria-expanded", this.#menuOpen.toString());
      });
    }
  }

  customElements.define("mobile-button", MobileNavBtn);
</script>
