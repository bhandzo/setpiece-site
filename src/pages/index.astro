---
import PageLayout from "@/layouts/Base.astro";
import { Image } from "astro:assets";
import hills from "@/content/images/hills.jpg";
import { createReader } from '@keystatic/core/reader';
import keystaticConfig from '../../keystatic.config';

const reader = createReader(process.cwd(), keystaticConfig);
const homepage = await reader.singletons.homepage.read();

// Provide default values if homepage data doesn't exist yet
const content = homepage || {
  heroTitle: 'When you hit a wall, we transform everything.',
  heroDescription: 'We are AI-native operating partners for SaaS leaders who\'ve hit a wall. Get unstuck and go fast (again).',
  mainProblemTitle: 'What got you here stopped working',
  mainProblemDescription: 'Whether you\'re finding product-market fit, scaling past early success, or managing explosive growth - what used to work is now making things worse. Every day feels like trying to stay afloat instead of building the future.',
  problemCards: [],
  differentiatorTitle: 'We\'re Built Different',
  differentiators: [],
  servicesTitle: 'Sprint to get unstuck',
  servicesSubtitle: 'How we work with you to get your groove back',
  servicesDescription: 'Strategy clarity first, then systematic transformation. No wasted effort optimizing the wrong things.',
  services: []
};
---

<PageLayout meta={{ title: "Home Page" }}>
  <!-- Hero image -->

  <section
    class="gc-full md:col-span-3 md:col-start-4 lg:col-span-5 lg:col-start-5 gr-span-2"
  >
    <h2 class="text-3xl md:text-4xl leading-snug mb-4">
      {content.heroTitle}
    </h2>
    <p class="text-sm leading-normal">
      {content.heroDescription}
    </p>
  </section>
  <section class="gc-full grid-local gr-span-5">
    <div class="gc-full gr-span-4">
      <Image
        src={hills}
        alt="Rolling hills landscape"
        class="w-full h-full object-cover object-top"
      />
    </div>
  </section>

  <!-- Hero statement -->

  <!-- Two-column editorial with asymmetric spans -->
  <section class="gc-full grid-local gr-span-6 border-t-[5px] border-black">
    <section class="gc-full grid-local gr-span-3 border-t-[5px]">
      <article class="col-span-3 md:col-span-5 lg:col-span-5">
        <h3 class="text-3xl md:text-4xl leading-snug mb-4">
          {content.mainProblemTitle}
        </h3>
        <p class="text-sm leading-normal">
          {content.mainProblemDescription}
        </p>
      </article>
    </section>
    {content.problemCards?.map((card) => (
      <section
        class="col-span-1 md:col-span-2 lg:col-span-3 border-t-[5px] border-black p-3"
      >
        <h4 class="text-xl mb-3">{card.title}</h4>
        <p class="text-sm leading-normal">
          {card.description}
        </p>
      </section>
    ))}
  </section>

  <!-- Differentiation -->
  <section class="gc-full grid-local gr-span-4">
    <article class="gc-full md:col-span-2 lg:col-span-2">
      <h3 class="text-3xl md:text-4xl leading-snug mb-4">
        {content.differentiatorTitle}
      </h3>
    </article>
    <div
      class="gc-full grid-local md:col-span-5 md:col-start-3 lg:col-span-6 lg:col-start-4"
    >
      {content.differentiators?.map((diff) => (
        <section class="gc-full border-t-[5px] border-black">
          <h4 class="text-xl mb-3">{diff.title}</h4>
          <p class="text-sm leading-normal">
            {diff.description}
          </p>
        </section>
      ))}
    </div>
  </section>

  <!-- Services -->
  <section class="gc-full grid-local gr-span-8 border-t-[5px] border-black">
    <section class="gc-full grid-local gr-span-2">
      <article
        class="col-span-3 md:col-start-1 md:col-span-5 lg:col-start-1 lg:col-span-7"
      >
        <h3 class="text-3xl md:text-4xl leading-snug mb-4">
          {content.servicesTitle}
        </h3>
        <p class="text-sm leading-normal">
          {content.servicesSubtitle}
        </p>
        <p class="text-sm leading-normal">
          {content.servicesDescription}
        </p>
      </article>
    </section>
    {content.services?.map((service, index) => (
      <section
        class={index === 0 ? "gc-full md:col-span-3 lg:col-span-4 border-t-[5px] border-black" : "col-span-1 md:col-span-3 lg:col-start-6 lg:col-span-4 border-t-[5px] border-black p-3"}
      >
        <h4 class="text-xl mb-3">{service.title}</h4>
        <div class="text-sm leading-normal">
          {service.description}
        </div>
      </section>
    ))}
  </section>
</PageLayout>

<!-- Three-column problem sections -->
