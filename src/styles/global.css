/* would like to ignore ./src/pages/og-image/[slug].png.ts */
@import "tailwindcss";
/* config for tailwindcss-typography plugin */
@config "../../tailwind.config.ts";

:root {
	color-scheme: light;
	--font-fallback-sans: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
	/* Mobile-first responsive grid */
	--cols: 3;                 /* mobile: 3 columns */
	--row: 80px;               /* row height (baseline module) */
	--gutter-x: 14px;          /* column gap */
	--gutter-y: 14px;          /* row gap */
	--margin: 3px;             /* inner margin around the grid - mobile first */
	--line: rgba(255,255,255,.85); /* overlay line color */
	--bg: #e85a14;             /* page background */
}

/* use a selector-based strategy for dark mode */
@variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

/* you could refactor below to use light-dark(), depending on your target audience */
@theme {
	--color-global-bg: oklch(98.48% 0 0);
	--color-global-text: oklch(26.99% 0.0096 235.05);
	--color-link: oklch(55.44% 0.0431 185.69);
	--color-accent: oklch(55.27% 0.195 19.06);
	--color-accent-2: oklch(18.15% 0 0);
	--color-quote: oklch(55.27% 0.195 19.06);
}


/* Responsive grid settings - mobile first approach */
@media (min-width: 640px)  { :root { --cols: 3; --margin: 14px; } } /* sm+ */
@media (min-width: 768px)  { :root { --cols: 6; --margin: 21px; } } /* md+ */
@media (min-width: 1024px) { :root { --cols: 9; --margin: 28px; } } /* lg+ */

@layer base {
	html, body {
		height: 100%;
	}

	body {
		margin: 0;
		color: #111;
		font-family: system-ui, sans-serif;
		/* if you want the poster centered vertically: */
	  }
	.grid-frame {
	/* size the "poster" area; adjust as you like */
	width: min(900px, 92vw);
	/* height can be fluid or fixed; pick one: */
	min-height: min(1280px, 140vh);
	
	padding: var(--margin);
	position: relative;
	
	/* Use Tailwind-compatible grid setup with CSS variables */
	display: grid;
	grid-template-columns: repeat(var(--cols), 1fr); /* responsive fr tracks */
	grid-auto-rows: var(--row);                      /* fixed row module */
	column-gap: var(--gutter-x);
	row-gap: var(--gutter-y);
	}
	
	/* Optional: a thin keyline artound the grid frame (like the poster border) */
	.grid-frame {
	outline: 2px solid rgba(255,255,255,.85);
	outline-offset: -2px; /* inside the padding */
	background:
    /* vertical lines every (track + gutter-x) */
    repeating-linear-gradient(
      to right,
      var(--line) 0 1px,
      transparent 1px calc(var(--track) + var(--gutter-x))
    ),
    /* horizontal lines every (row + gutter-y) */
    repeating-linear-gradient(
      to bottom,
      var(--line) 0 1px,
      transparent 1px calc(var(--row) + var(--gutter-y))
    );
  background-clip: content-box; /* keep lines inside the padded area */
	}

	/* ---- Grid system using Tailwind patterns ---- */
	
/* Essential grid helpers that coordinate with CSS variables */
.grid-local {
	display: grid;
	grid-template-columns: repeat(var(--cols), 1fr);
	grid-auto-rows: var(--row);
	column-gap: var(--gutter-x);
	row-gap: var(--gutter-y);
}

/* Responsive grid column utilities */
.gc-full { grid-column: 1 / -1; }

/* Mobile-first approach: 3 columns base */
.gc-third { grid-column: span 1; }
.gc-two-thirds { grid-column: span 2; }

/* Tablet: 6 columns */
@media (min-width: 768px) {
  .md\:gc-half { grid-column: span 3; }
  .md\:gc-third { grid-column: span 2; }
  .md\:gc-two-thirds { grid-column: span 4; }
}

/* Desktop: 9 columns */
@media (min-width: 1024px) {
  .lg\:gc-half { grid-column: span 4; }
  .lg\:gc-third { grid-column: span 3; }
  .lg\:gc-two-thirds { grid-column: span 6; }
}

/* Row span utilities following Tailwind naming */
/* Row spans (apply to grid items) */
.gr-span-1{ grid-row: span 1; }
.gr-span-2{ grid-row: span 2; }
.gr-span-3{ grid-row: span 3; }
.gr-span-4{ grid-row: span 4; }
.gr-span-5{ grid-row: span 5; }
.gr-span-6{ grid-row: span 6; }
.gr-span-8{ grid-row: span 8; }
.gr-span-12{ grid-row: span 12; }
	html {
		color-scheme: light dark;
		accent-color: var(--color-accent);
		scrollbar-gutter: stable;

		&[data-theme="light"] {
			color-scheme: light;
		}

		&[data-theme="dark"] {
			color-scheme: dark;
			--color-global-bg: oklch(23.64% 0.0045 248);
			--color-global-text: oklch(83.54% 0 264);
			--color-link: oklch(70.44% 0.1133 349);
			--color-accent: oklch(70.91% 0.1415 163.7);
			--color-accent-2: oklch(94.66% 0 0);
			--color-quote: oklch(94.8% 0.106 136.49);
		}
	}

	/* Body styles consolidated above in the first body rule */

	:target {
		scroll-margin-block: 5ex;
	}

	@view-transition {
		navigation: auto;
	}

	/* Astro image responsive styles, modified from -> https://docs.astro.build/en/guides/images/#responsive-image-styles */
	:where([data-astro-image]) {
		object-fit: var(--fit);
		object-position: var(--pos);
	}
	[data-astro-image="full-width"] {
		width: 100%;
	}
	[data-astro-image="constrained"] {
		max-width: 100%;
	}
}

@layer components {
	@import "./components/admonition.css";
	@import "./components/github-card.css";

	.cactus-link {
		@apply hover:decoration-link underline underline-offset-2 hover:decoration-2;
	}

	.title {
		@apply text-accent-2 text-2xl font-semibold;
	}

	/* typographic defaults */
	.prose {
		@apply leading-normal max-w-measure;
	}

	h1, h2, h3, h4 {
		@apply tracking-tight;
	}
}

@utility prose {
	--tw-prose-body: var(--color-global-text);
	--tw-prose-bold: var(--color-global-text);
	--tw-prose-bullets: var(--color-global-text);
	--tw-prose-code: var(--color-global-text);
	--tw-prose-headings: var(--color-accent-2);
	--tw-prose-hr: 0.5px dashed #666;
	--tw-prose-links: var(--color-global-text);
	--tw-prose-quotes: var(--color-quote);
	--tw-prose-th-borders: #666;
}
